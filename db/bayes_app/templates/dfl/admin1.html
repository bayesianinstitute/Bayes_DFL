<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Federated Learning Admin Dashboard</title>
    <!-- Include Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <!-- Include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      /* Style to make charts smaller */
      canvas {
        max-width: 100%;
        height: auto;
      }
    </style>
  </head>

  <body>
    <!-- Header -->
    <header>
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Admin Dashboard</a>
      </nav>
    </header>

    <div class="container mt-4">
      <div class="row">
        <!-- User Table -->
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h1 class="card-title">Users</h1>
            </div>
            <div class="card-body">
              <!-- Display user information in a table -->
              <table class="table">
                <thead>
                  <tr>
                    <th>Node Id</th>
                    <th>User Role</th>
                    <th>Training Status</th>
                    <th>Network Status</th>
                  </tr>
                </thead>
                <tbody id="user-table-body">
                  <!-- User data will be dynamically added here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Chart Section -->
        <div class="col-12 col-md-4">
          <div class="card mt-4">
            <div class="card-header">
              <h1 class="card-title">Training Progress</h1>
            </div>
            <div class="card-body">
              <!-- Bar Chart Canvas -->
              <canvas id="training-chart" width="200" height="100"></canvas>
            </div>
          </div>
        </div>

        <!-- Line Chart Section for Epochs -->
        <div class="col-12 col-md-4">
          <div class="card mt-4">
            <div class="card-header">
              <h1 class="card-title">Epochs</h1>
            </div>
            <div class="card-body">
              <!-- Line Chart Canvas for Epochs -->
              <canvas id="epochs-chart" width="300" height="150"></canvas>
            </div>
          </div>
        </div>

        <!-- Line Chart Section for Loss -->
        <div class="col-12 col-md-4">
          <div class="card mt-4">
            <div class="card-header">
              <h1 class="card-title">Loss</h1>
            </div>
            <div class="card-body">
              <!-- Line Chart Canvas for Loss -->
              <canvas id="loss-chart" width="300" height="150"></canvas>
            </div>
          </div>
        </div>

        <!-- Line Chart Section for Validation Accuracy -->
        <div class="col-12 col-md-4">
          <div class="card mt-4">
            <div class="card-header">
              <h1 class="card-title">Validation Accuracy</h1>
            </div>
            <div class="card-body">
              <!-- Line Chart Canvas for Validation Accuracy -->
              <canvas
                id="validation-accuracy-chart"
                width="300"
                height="150"
              ></canvas>
            </div>
          </div>
        </div>

        <!-- Pie Chart Section for Training Progress Distribution -->
        <div class="col-12 col-md-4">
          <div class="card mt-4">
            <div class="card-header">
              <h1 class="card-title">Training Progress Distribution</h1>
            </div>
            <div class="card-body">
              <!-- Pie Chart Canvas for Training Progress Distribution -->
              <canvas
                id="progress-distribution-chart"
                width="300"
                height="150"
              ></canvas>
            </div>
          </div>
        </div>

        <!-- Doughnut Chart Section for Loss Distribution -->
        <div class="col-12 col-md-4">
          <div class="card mt-4">
            <div class="card-header">
              <h1 class="card-title">Loss Distribution</h1>
            </div>
            <div class="card-body">
              <!-- Doughnut Chart Canvas for Loss Distribution -->
              <canvas
                id="loss-distribution-chart"
                width="300"
                height="150"
              ></canvas>
            </div>
          </div>
        </div>

        <!-- Radar Chart Section for Multi-dimensional Metrics -->
        <div class="col-12 col-md-4">
          <div class="card mt-4">
            <div class="card-header">
              <h1 class="card-title">Metrics Comparison</h1>
            </div>
            <div class="card-body">
              <!-- Radar Chart Canvas for Multi-dimensional Metrics -->
              <canvas
                id="metrics-radar-chart"
                width="300"
                height="150"
              ></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Include Bootstrap and other JavaScript libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
      // Dummy training data for the bar chart
      const trainingData = {
        labels: ['User1', 'User2'],
        datasets: [
          {
            label: 'Accuracy',
            data: [0.85, 0.78],
            backgroundColor: [
              'rgba(75, 192, 192, 0.2)',
              'rgba(255, 99, 132, 0.2)',
            ],
            borderColor: ['rgba(75, 192, 192, 1)', 'rgba(255, 99, 132, 1)'],
            borderWidth: 1,
          },
        ],
      }

      // Dummy data for line charts
      const epochsData = {
        labels: ['Epoch 1', 'Epoch 2', 'Epoch 3', 'Epoch 4', 'Epoch 5'],
        datasets: [
          {
            label: 'User1',
            data: [10, 20, 15, 25, 30],
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1,
            fill: false,
          },
          {
            label: 'User2',
            data: [15, 25, 18, 30, 35],
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1,
            fill: false,
          },
        ],
      }

      const lossData = {
        labels: ['Epoch 1', 'Epoch 2', 'Epoch 3', 'Epoch 4', 'Epoch 5'],
        datasets: [
          {
            label: 'User1',
            data: [0.5, 0.4, 0.3, 0.2, 0.1],
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1,
            fill: false,
          },
          {
            label: 'User2',
            data: [0.4, 0.3, 0.2, 0.1, 0.05],
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1,
            fill: false,
          },
        ],
      }

      const validationAccuracyData = {
        labels: ['Epoch 1', 'Epoch 2', 'Epoch 3', 'Epoch 4', 'Epoch 5'],
        datasets: [
          {
            label: 'User1',
            data: [0.8, 0.85, 0.88, 0.9, 0.92],
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1,
            fill: false,
          },
          {
            label: 'User2',
            data: [0.75, 0.82, 0.87, 0.91, 0.94],
            borderColor: 'rgba(255, 99, 132, 1)',
            borderWidth: 1,
            fill: false,
          },
        ],
      }

      // Dummy data for pie chart
      const progressDistributionData = {
        labels: ['Completed', 'In Progress', 'Not Started'],
        datasets: [
          {
            data: [30, 60, 10],
            backgroundColor: ['#28a745', '#ffc107', '#dc3545'],
          },
        ],
      }

      // Dummy data for doughnut chart
      const lossDistributionData = {
        labels: ['User1', 'User2'],
        datasets: [
          {
            data: [15, 25],
            backgroundColor: ['#007bff', '#6610f2'],
          },
        ],
      }

      // Dummy data for radar chart
      const metricsData = {
        labels: ['Accuracy', 'Precision', 'Recall', 'F1 Score', 'Loss'],
        datasets: [
          {
            label: 'User1',
            data: [0.85, 0.78, 0.82, 0.8, 0.2],
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
          },
          {
            label: 'User2',
            data: [0.78, 0.75, 0.88, 0.85, 0.3],
            borderColor: 'rgba(255, 99, 132, 1)',
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
          },
        ],
      }

      // Function to render user table
      function renderUserTable(adminData) {
        const userTableBody = document.getElementById('user-table-body')
        userTableBody.innerHTML = ''

        // Create a new row for the fetched admin data
        const row = document.createElement('tr')
        row.innerHTML = `
          <td>${adminData.node_id}</td>
          <td>Admin</td>
          <td>${adminData.training_status}</td>
          <td>${adminData.network_status}</td>
        `

        // Append the row to the table body
        userTableBody.appendChild(row)
      }

      // Function to fetch admin data from the API
      async function fetchAdminData() {
        try {
          const response = await fetch(
            'http://127.0.0.1:8000/api/v1/get-admin-data/'
          )
          const adminData = await response.json()

          // Process the received data and update the table
          renderUserTable(adminData)
        } catch (error) {
          console.error('Error fetching admin data:', error)
        }
      }

      // Function to render training chart
      function renderTrainingChart() {
        const ctx = document.getElementById('training-chart').getContext('2d')
        const trainingChart = new Chart(ctx, {
          type: 'bar',
          data: trainingData,
          options: {
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        })
      }

      // Function to render line charts
      function renderLineChart(chartId, chartData) {
        const ctx = document.getElementById(chartId).getContext('2d')
        const lineChart = new Chart(ctx, {
          type: 'line',
          data: chartData,
          options: {
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        })
      }

      // Function to render pie chart
      function renderPieChart(chartId, chartData) {
        const ctx = document.getElementById(chartId).getContext('2d')
        const pieChart = new Chart(ctx, {
          type: 'pie',
          data: chartData,
        })
      }

      // Function to render doughnut chart
      function renderDoughnutChart(chartId, chartData) {
        const ctx = document.getElementById(chartId).getContext('2d')
        const doughnutChart = new Chart(ctx, {
          type: 'doughnut',
          data: chartData,
        })
      }

      // Function to render radar chart
      function renderRadarChart(chartId, chartData) {
        const ctx = document.getElementById(chartId).getContext('2d')
        const radarChart = new Chart(ctx, {
          type: 'radar',
          data: chartData,
        })
      }

      // Call the render functions when the page loads
      renderTrainingChart()
      renderLineChart('epochs-chart', epochsData)
      renderLineChart('loss-chart', lossData)
      renderLineChart('validation-accuracy-chart', validationAccuracyData)
      renderPieChart('progress-distribution-chart', progressDistributionData)
      renderDoughnutChart('loss-distribution-chart', lossDistributionData)
      renderRadarChart('metrics-radar-chart', metricsData)
      fetchAdminData()
    </script>
  </body>
</html>
